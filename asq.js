/*! asynquence
    v0.0.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(a){function d(){function a(){function a(){clearTimeout(u),u=null,q.length=0,r.length=0,s.length=0,t.length=0}function b(){return o?d():(u||(u=setTimeout(d,0)),void 0)}function d(){var c,d;if(u=null,o)a();else if(n)for(;r.length;){c=r.shift();try{c.apply(c,t)}catch(f){t.push(f),f.stack&&t.push(f.stack),0===r.length&&console.error.apply(console,t)}}else if(p&&q.length>0){p=!1,c=q.shift(),d=s.slice(),s.length=0,d.unshift(e());try{c.apply(c,d)}catch(f){t.push(f),n=!0,b()}}}function e(){function a(){n||o||p||(p=!0,s.push.apply(s,arguments),t.length=0,b())}return a.fail=function(){n||o||p||(n=!0,s.length=0,t.push.apply(t,arguments),b())},a.abort=function(){n||o||(p=!1,o=!0,s.length=0,t.length=0,b())},a}function f(a,b){function d(){clearTimeout(u),u=q=r=t=null}function e(){return j?f():(u||(u=setTimeout(f,0)),void 0)}function f(){if(!(n||o||k)){var b,c=[];if(u=null,i)a.fail.apply(a,t),d();else if(j)a.abort(),d();else if(g()){for(k=!0,b=0;b<q.length;b++)c.push(r["m"+b]);a.apply(a,c),d()}}}function g(){if(!(n||o||i||j||k||0===q.length)){var a,b=!0;for(a=0;a<q.length;a++)if(null===q[a]){b=!1;break}return b}}function h(){function a(){if(!(n||o||i||j||k||q[b])){var a=c.call(arguments);r["m"+b]=a.length>1?a:a[0],q[b]=!0,e()}}var b=q.length;return a.fail=function(){n||o||i||j||k||q[b]||(i=!0,t=c.call(arguments),e())},a.abort=function(){n||o||i||j||k||(j=!0,f())},q[b]=null,a}var l,m,p,t,u,i=!1,j=!1,k=!1,q=[],r={};for(l=0;l<b.length&&!i&&!j;l++){m=s.slice(),m.unshift(h());try{b[l].apply(b[l],m)}catch(v){p=v,i=!0;break}}p&&a.fail(p)}function g(){return n||o?v:(arguments.length>0&&q.push.apply(q,arguments),b(),v)}function h(){return o?v:(r.push.apply(r,arguments),b(),v)}function i(){if(n||o||0===arguments.length)return v;var a=c.apply(arguments);return g(function(b){f(b,a)}),v}function j(){if(n||o||0===arguments.length)return v;var a,b=c.call(arguments);for(a=0;a<b.length;a++)!function(a){g(function(b){var d=c.call(arguments,1);a.apply(a,d),b()}).or(a.fail)}(b[a]);return v}function k(){if(n||o||0===arguments.length)return v;var a,b=c.call(arguments);for(a=0;a<b.length;a++)!function(a){g(function(b){var d=c.call(arguments,1);a.apply(a,d).pipe(b)})}(b[a]);return v}function l(){if(n||o||0===arguments.length)return v;var a,b=c.call(arguments);for(a=0;a<b.length;a++)!function(a){g(function(b){var d=c.call(arguments,1);b(a.apply(a,d))})}(b[a]);return v}function m(){return n?v:(o=!0,d(),v)}var u,n=!1,o=!1,p=!0,q=[],r=[],s=[],t=[],v={then:g,or:h,gate:i,pipe:j,seq:k,val:l,abort:m};return arguments.length>0&&v.then.apply(v,arguments),v}return a}var b=a.ASQ,c=Array.prototype.slice;a.ASQ=d(),a.ASQ.noConflict=function(){var c=a.ASQ;return a.ASQ=b,c}}(this);
